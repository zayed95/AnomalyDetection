"use strict";(self.webpackChunk_mlflow_mlflow=self.webpackChunk_mlflow_mlflow||[]).push([[9146],{27556:function(e,t,n){n.d(t,{YQ:function(){return o},d7:function(){return a}});var r=n(46709);function o(e,t,n){var o=this,i=(0,r.useRef)(null),a=(0,r.useRef)(0),s=(0,r.useRef)(null),l=(0,r.useRef)([]),u=(0,r.useRef)(),d=(0,r.useRef)(),c=(0,r.useRef)(e),m=(0,r.useRef)(!0);c.current=e;var p="undefined"!=typeof window,h=!t&&0!==t&&p;if("function"!=typeof e)throw new TypeError("Expected a function");t=+t||0;var g=!!(n=n||{}).leading,f=!("trailing"in n)||!!n.trailing,v="maxWait"in n,y="debounceOnServer"in n&&!!n.debounceOnServer,b=v?Math.max(+n.maxWait||0,t):null;(0,r.useEffect)((function(){return m.current=!0,function(){m.current=!1}}),[]);var R=(0,r.useMemo)((function(){var e=function(e){var t=l.current,n=u.current;return l.current=u.current=null,a.current=e,d.current=c.current.apply(n,t)},n=function(e,t){h&&cancelAnimationFrame(s.current),s.current=h?requestAnimationFrame(e):setTimeout(e,t)},r=function(e){if(!m.current)return!1;var n=e-i.current;return!i.current||n>=t||n<0||v&&e-a.current>=b},R=function(t){return s.current=null,f&&l.current?e(t):(l.current=u.current=null,d.current)},w=function e(){var o=Date.now();if(r(o))return R(o);if(m.current){var s=t-(o-i.current),l=v?Math.min(s,b-(o-a.current)):s;n(e,l)}},x=function(){if(p||y){var c=Date.now(),h=r(c);if(l.current=[].slice.call(arguments),u.current=o,i.current=c,h){if(!s.current&&m.current)return a.current=i.current,n(w,t),g?e(i.current):d.current;if(v)return n(w,t),e(i.current)}return s.current||n(w,t),d.current}};return x.cancel=function(){s.current&&(h?cancelAnimationFrame(s.current):clearTimeout(s.current)),a.current=0,l.current=i.current=u.current=s.current=null},x.isPending=function(){return!!s.current},x.flush=function(){return s.current?R(Date.now()):d.current},x}),[g,v,t,b,f,h,p,y]);return R}function i(e,t){return e===t}function a(e,t,n){var a=n&&n.equalityFn||i,s=(0,r.useRef)(e),l=(0,r.useState)({})[1],u=o((0,r.useCallback)((function(e){s.current=e,l({})}),[l]),t,n),d=(0,r.useRef)(e);return a(d.current,e)||(u(e),d.current=e),[s.current,u]}},29774:function(e,t,n){n.d(t,{Au:function(){return s},tF:function(){return l}});var r=n(46709),o=n(36476),i=n(73408);const a=(0,r.createContext)({currentUserActionError:null,handleError:()=>{},handlePromise:()=>{},clearUserActionError:()=>{}}),s=({children:e,errorFilter:t})=>{const[n,s]=(0,r.useState)(null),l=(0,r.useCallback)(((e,n)=>{if(null===t||void 0===t||!t(e)){const t=(0,o.a$)(e);s(t),n&&n(t)}}),[s,t]),u=(0,r.useCallback)((e=>{e.catch((e=>{l(e)}))}),[l]),d=(0,r.useCallback)((()=>{s(null)}),[s]);return(0,i.Y)(a.Provider,{value:(0,r.useMemo)((()=>({currentUserActionError:n,handleError:l,handlePromise:u,clearUserActionError:d})),[d,n,l,u]),children:e})},l=()=>{const{currentUserActionError:e,handleError:t,handlePromise:n,clearUserActionError:o}=(0,r.useContext)(a),i=(0,r.useCallback)(((e,n,r)=>{t(n,r)}),[t]);return(0,r.useMemo)((()=>({currentUserActionError:e,handleError:t,handleErrorWithEvent:i,handlePromise:n,clearUserActionError:o})),[o,t,n,e,i])}},33972:function(e,t,n){n.d(t,{i:function(){return i}});var r=n(76118),o=n(46709);const i=(e,t)=>{const n=(0,o.useRef)();return n.current&&(0,r.isEqual)(t,n.current.deps)||(n.current={deps:t,value:e()}),n.current.value}},43976:function(e,t,n){n.r(t),n.d(t,{default:function(){return mt}});var r=n(68248),o=n(59930),i=n.n(o),a=n(46709),s=n(95328),l=n(29774),u=n(89949),d=n(27299),c=n(27757),m=n(40724),p=n(73408);var h={name:"1vfb318",styles:"flex:1;display:flex;align-items:center;justify-content:center"};const g=({error:e})=>{var t;return(0,p.Y)(d.PageWrapper,{css:h,children:(0,p.Y)(d.Empty,{"data-testid":"fallback",title:(0,p.Y)(m.A,{id:"w80phd",defaultMessage:"Error"}),description:null!==(t=null===e||void 0===e?void 0:e.message)&&void 0!==t?t:(0,p.Y)(m.A,{id:"tQrhZ8",defaultMessage:"An error occurred while rendering this component."}),image:(0,p.Y)(c.k,{})})})},f=({children:e,resetKey:t})=>(0,p.Y)(u.tH,{FallbackComponent:g,resetKeys:[t],children:(0,p.Y)(l.Au,{children:e})});var v=n(76256),y=n(77680),b=n(79081),R=n(91105),w=n(70513),x=n(60284),S=n(49620),C=n(67063),D=n(50383);const M=(e,t)=>[e,t].join("."),Y=e=>{const[t,...n]=e.split(".");if(n.length&&Object.values(oe).includes(t))return{columnType:t,key:n.join(".")}};var I=n(34931);const T=(0,a.createContext)({isRowHidden:()=>!1,toggleRowVisibility:()=>{},setVisibilityMode:()=>{},visibilityMode:I.oy.SHOWALL,usingCustomVisibility:!1,allRunsHidden:!1}),A=({children:e})=>{const[t,n]=(0,a.useState)(new Set),[r,o]=(0,a.useState)(I.oy.SHOWALL),i=(0,a.useCallback)(((e,n,o)=>r===I.oy.CUSTOM?t.has(e):r===I.oy.HIDEALL||(r===I.oy.FIRST_10_RUNS?n>=10:r===I.oy.FIRST_20_RUNS?n>=20:r===I.oy.HIDE_FINISHED_RUNS&&["FINISHED","FAILED","KILLED"].includes(null!==o&&void 0!==o?o:""))),[t,r]),s=(0,a.useCallback)((e=>{n((t=>{const n=new Set(t);return n.has(e)?n.delete(e):n.add(e),n})),o(I.oy.CUSTOM)}),[]),l=(0,a.useCallback)((e=>{o(e),e!==I.oy.CUSTOM&&n(new Set)}),[]),u=r===I.oy.CUSTOM&&t.size>0,d=r===I.oy.HIDEALL,c=(0,a.useMemo)((()=>({isRowHidden:i,toggleRowVisibility:s,setVisibilityMode:l,visibilityMode:r,usingCustomVisibility:u,allRunsHidden:d})),[i,s,l,r,u,d]);return(0,p.Y)(T.Provider,{value:c,children:e})},k=()=>(0,a.useContext)(T);var E=n(44105);const F=({row:e,table:{options:{meta:t}}})=>"subRuns"in e.original?(0,p.Y)("div",{children:"-"}):(0,p.Y)(d.Checkbox,{componentId:"mlflow.eval-runs.checkbox-cell","data-testid":`eval-runs-table-cell-checkbox-${e.id}`,disabled:!e.getCanSelect(),isChecked:e.getIsSelected(),wrapperStyle:{padding:0,margin:0},onChange:()=>e.toggleSelected()});var L={name:"y1ecum",styles:"text-overflow:ellipsis;white-space:nowrap;overflow:hidden;flex-shrink:1"};const H=({row:e,table:{options:{meta:t}}})=>{const{theme:n}=(0,c.u)(),o=(0,S.MQ)(),i=(0,S.LE)();if("subRuns"in e.original)return(0,p.Y)("div",{children:"-"});const a=e.original.info.runUuid;return(0,p.FD)("div",{css:(0,r.AH)({overflow:"hidden",display:"flex",alignItems:"center",gap:n.spacing.xs},""),onClick:()=>{var e,n;null===(e=(n=t).setSelectedRunUuid)||void 0===e||e.call(n,a)},children:[(0,p.Y)(C.E,{color:i(a),onChangeColor:e=>o({runUuid:a,colorValue:e})}),(0,p.Y)(c.T.Link,{css:L,componentId:"mlflow.eval-runs.run-name-cell",id:"run-name-cell",children:e.original.info.runName}),(0,p.Y)("div",{css:(0,r.AH)({display:"none",flexShrink:0,".eval-runs-table-row:hover &":{display:"inline"},svg:{width:n.typography.fontSizeMd,height:n.typography.fontSizeMd}},""),children:(0,p.Y)(R.N_,{target:"_blank",rel:"noreferrer",to:x.Ay.getRunPageTabRoute(e.original.info.experimentId,a,E.N3.EVALUATIONS),children:(0,p.Y)(b.T,{content:(0,p.Y)(m.A,{id:"T3RjOb",defaultMessage:"Go to the run"}),componentId:"mlflow.eval-runs.run-name-cell.tooltip",children:(0,p.Y)(c.B,{type:"link",target:"_blank",icon:(0,p.Y)(c.au,{}),size:"small",componentId:"mlflow.eval-runs.run-name-cell.open-run-page"})})})})]})};var O={name:"1kvqz6y",styles:"& > svg{width:12px;height:12px;}"},U={name:"1bnhmdk",styles:"overflow:hidden;text-overflow:ellipsis;text-wrap:nowrap"},N={name:"1cot5qr",styles:"max-width:100%;margin-right:0"};const B=({row:e,table:{options:{meta:t}}})=>{var n,o,i,a;const{theme:s}=(0,c.u)();if("subRuns"in e.original)return(0,p.Y)("div",{children:"-"});const l=e.original,u=null!==(n=null===(o=l.inputs)||void 0===o?void 0:o.datasetInputs)&&void 0!==n?n:[],m=null!==(i=null===(a=u[0])||void 0===a?void 0:a.dataset)&&void 0!==i?i:null;if(!m)return(0,p.Y)("div",{children:"-"});const h=(0,p.FD)("div",{css:(0,r.AH)({display:"flex",alignItems:"center",gap:s.spacing.xs,maxWidth:"100%",color:s.colors.textPrimary},""),children:[(0,p.Y)(d.TableIcon,{css:O}),(0,p.Y)(c.T.Text,{css:U,children:m.name})]});return(0,p.Y)("div",{children:(0,p.Y)(b.T,{componentId:"mlflow.eval-runs.dataset-cell-tooltip",content:m.name,children:(0,p.Y)(d.Tag,{componentId:"mlflow.eval-runs.dataset-cell",onClick:()=>{var e,n,r,o;t.setSelectedDatasetWithRun({datasetWithTags:{dataset:m},runData:{experimentId:null===(e=l.info)||void 0===e?void 0:e.experimentId,runUuid:null!==(n=null===(r=l.info)||void 0===r?void 0:r.runUuid)&&void 0!==n?n:"",runName:null===(o=l.info)||void 0===o?void 0:o.runName,datasets:u}}),t.setIsDrawerOpen(!0)},id:"dataset-cell",css:N,children:h})})})};var _={name:"18x9eu",styles:"max-width:100%;margin-right:0;cursor:pointer"},z={name:"qhxz92",styles:"max-width:100%"},q={name:"1bnhmdk",styles:"overflow:hidden;text-overflow:ellipsis;text-wrap:nowrap"};const P=({row:e})=>{var t,n,o,i,a;const s="inputs"in e.original?null===(t=e.original.inputs)||void 0===t||null===(n=t.modelInputs)||void 0===n||null===(o=n[0])||void 0===o?void 0:o.modelId:void 0,{theme:l}=(0,c.u)(),{data:u,isLoading:m}=(0,w.b3)({loggedModelId:s,enabled:Boolean(s)});if(!s||"subRuns"in e.original)return(0,p.Y)("div",{children:"-"});const h=null!==(i=null===u||void 0===u||null===(a=u.info)||void 0===a?void 0:a.name)&&void 0!==i?i:s;return m?(0,p.Y)(d.ParagraphSkeleton,{}):(0,p.Y)(b.T,{componentId:"mlflow.eval-runs.model-version-cell-tooltip",content:h,children:(0,p.Y)(d.Tag,{componentId:"mlflow.eval-runs.model-version-cell",id:"model-version-cell",css:_,children:(0,p.Y)(R.N_,{to:x.Ay.getExperimentLoggedModelDetailsPageRoute(e.original.info.experimentId,s),target:"_blank",css:z,children:(0,p.FD)("div",{css:(0,r.AH)({display:"flex",alignItems:"center",gap:l.spacing.xs,maxWidth:"100%"},""),children:[(0,p.Y)(d.ModelsIcon,{css:(0,r.AH)({"& > svg":{width:12,height:12,color:l.colors.textPrimary}},"")}),(0,p.Y)(c.T.Text,{css:q,children:h})]})})})})},V=({getValue:e})=>{const t=e();return(0,p.Y)("span",{title:t,children:null!==t&&void 0!==t?t:"-"})};var W={name:"1bnhmdk",styles:"overflow:hidden;text-overflow:ellipsis;text-wrap:nowrap"},K={name:"zfbdj8",styles:"display:none;flex-shrink:0"};const j=({column:e,title:t})=>{const{theme:n}=(0,c.u)(),o=(0,a.useMemo)((()=>{var t,n;return null!==(t=null===(n=Y(e.id))||void 0===n?void 0:n.key)&&void 0!==t?t:e.id}),[e.id]);return(0,p.FD)("div",{css:(0,r.AH)({overflow:"hidden",display:"flex",alignItems:"center",gap:n.spacing.xs,":hover":{cursor:"pointer","& > div":{display:"inline"}}},""),children:[(0,p.Y)(b.T,{componentId:`mlflow.eval-runs.sortable-header-cell.tooltip-${e.id}`,content:o,children:(0,p.Y)("span",{css:W,children:(0,p.Y)(c.T.Text,{bold:!0,children:null!==t&&void 0!==t?t:o})})}),!e.getIsSorted()&&(0,p.Y)("div",{css:K,children:(0,p.Y)(d.SortUnsortedIcon,{})})]})},Q=({row:e})=>{if("subRuns"in e.original)return(0,p.Y)("div",{children:"-"});const t=e.original.info.startTime;return t?(0,p.Y)(D.f,{date:new Date(Number(t))}):(0,p.Y)("div",{children:"-"})};var G={name:"e0dnmk",styles:"cursor:pointer"};const $=({row:e,table:t})=>{const{isRowHidden:n,toggleRowVisibility:r}=k();if("subRuns"in e.original)return(0,p.Y)("div",{children:"-"});const o=e.original.info.runUuid,i=e.index,a=e.original.info.status,s=n(o,i,a)?d.VisibleOffIcon:d.VisibleIcon;return(0,p.Y)(s,{onClick:()=>r(o),css:G})};var Z=n(21678);let X=function(e){return e.TRACES="traces",e.CHARTS="charts",e}({});const J="viewMode";var ee=n(7655);const te=a.memo((()=>{const{theme:e}=(0,c.u)(),t=(0,ee.A)(),{visibilityMode:n,setVisibilityMode:r,usingCustomVisibility:o,allRunsHidden:i}=k();return(0,p.FD)(d.DropdownMenu.Root,{modal:!1,children:[(0,p.Y)(d.DropdownMenu.Trigger,{asChild:!0,children:(0,p.Y)("button",{css:ne.actionButton(e),"data-testid":"eval-runs-visibility-column-header","aria-label":t.formatMessage({id:"wKXJ6U",defaultMessage:"Toggle visibility of evaluation runs"}),children:n===I.oy.HIDEALL||n===I.oy.HIDE_FINISHED_RUNS||i?(0,p.Y)(d.VisibleOffIcon,{}):(0,p.Y)(d.VisibleIcon,{})})}),(0,p.Y)(d.DropdownMenu.Content,{children:(0,p.FD)(d.DropdownMenu.RadioGroup,{componentId:"mlflow.eval-runs.visibility-mode-selector",value:n,onValueChange:e=>r(e),children:[(0,p.FD)(d.DropdownMenu.RadioItem,{value:I.oy.FIRST_10_RUNS,children:[(0,p.Y)(d.DropdownMenu.ItemIndicator,{children:o?(0,p.Y)(d.DashIcon,{}):null}),(0,p.Y)(m.A,{id:"vEuvEt",defaultMessage:"Show first 10"})]}),(0,p.FD)(d.DropdownMenu.RadioItem,{value:I.oy.FIRST_20_RUNS,children:[(0,p.Y)(d.DropdownMenu.ItemIndicator,{children:o?(0,p.Y)(d.DashIcon,{}):null}),(0,p.Y)(m.A,{id:"LK+UHk",defaultMessage:"Show first 20"})]}),(0,p.FD)(d.DropdownMenu.RadioItem,{value:I.oy.SHOWALL,children:[(0,p.Y)(d.DropdownMenu.ItemIndicator,{children:o?(0,p.Y)(d.DashIcon,{}):null}),(0,p.Y)(m.A,{id:"WDqWWa",defaultMessage:"Show all runs"})]}),(0,p.FD)(d.DropdownMenu.RadioItem,{value:I.oy.HIDEALL,children:[(0,p.Y)(d.DropdownMenu.ItemIndicator,{children:o?(0,p.Y)(d.DashIcon,{}):null}),(0,p.Y)(m.A,{id:"QH2RJZ",defaultMessage:"Hide all runs"})]}),(0,p.FD)(d.DropdownMenu.RadioItem,{value:I.oy.HIDE_FINISHED_RUNS,children:[(0,p.Y)(d.DropdownMenu.ItemIndicator,{children:o?(0,p.Y)(d.DashIcon,{}):null}),(0,p.Y)(m.A,{id:"Q7MSrQ",defaultMessage:"Hide finished runs"})]})]})})]})})),ne={actionButton:e=>({background:"transparent",border:"none",cursor:"pointer",padding:0,margin:0,display:"inline-flex",alignItems:"center",justifyContent:"flex-start",verticalAlign:"text-bottom",minWidth:24,minHeight:24,svg:{width:e.general.iconFontSize,height:e.general.iconFontSize,cursor:"pointer",color:e.colors.textPrimary,flexShrink:0}})};let re=function(e){return e.checkbox="checkbox",e.visibility="visibility",e.runName="run_name",e.dataset="dataset",e.modelVersion="model_version",e.createdAt="created_at",e}({}),oe=function(e){return e.ATTRIBUTE="attribute",e.METRIC="metric",e.PARAM="param",e.TAG="tag",e}({});const ie=new Set([re.checkbox,re.visibility,re.runName]),ae={[re.checkbox]:!0,[re.visibility]:!0,[re.runName]:!0,[re.createdAt]:!0,[re.dataset]:!0,[re.modelVersion]:!0},se={[re.checkbox]:(0,y.zR)({id:"TQ3N+4",defaultMessage:"Select"}),[re.visibility]:(0,y.zR)({id:"6ZhLfu",defaultMessage:"Visibility"}),[re.runName]:(0,y.zR)({id:"TWnsnV",defaultMessage:"Run Name"}),[re.createdAt]:(0,y.zR)({id:"2OrFCG",defaultMessage:"Created at"}),[re.dataset]:(0,y.zR)({id:"SQUVnW",defaultMessage:"Dataset"}),[re.modelVersion]:(0,y.zR)({id:"CZXHRi",defaultMessage:"Version"})},le={[oe.ATTRIBUTE]:(0,y.zR)({id:"4HKr3y",defaultMessage:"Attributes"}),[oe.METRIC]:(0,y.zR)({id:"zZCBR9",defaultMessage:"Metrics"}),[oe.PARAM]:(0,y.zR)({id:"mY6f0y",defaultMessage:"Params"}),[oe.TAG]:(0,y.zR)({id:"HbC1a1",defaultMessage:"Tags"})};var ue=n(90061),de=n(43617),ce=n(1475);var me={name:"ti75j2",styles:"margin:0"},pe={name:"14sng3t",styles:"max-width:100px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis"};const he=({groupKey:e,groupValue:t})=>{const{theme:n}=(0,c.u)();return(0,p.Y)(b.T,{content:e+": "+t,componentId:"mlflow.eval-runs.group-tag",children:(0,p.FD)(d.Tag,{css:me,componentId:"mlflow.eval-runs.group-tag",children:[(0,p.FD)(c.T.Text,{bold:!0,css:(0,r.AH)({maxWidth:100,marginRight:n.spacing.xs,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},""),children:[e,":"]}),(0,p.Y)(c.T.Text,{css:pe,children:t})]})})},ge=({groupValues:e})=>{const t=e.groupByData;return e.mode===ce.uq.Dataset?(0,p.Y)(he,{groupKey:"Dataset",groupValue:String(e.value)},t):(0,p.Y)(he,{groupKey:t,groupValue:String(e.value)},t)};var fe={name:"ozd7xs",styles:"flex-shrink:0"};const ve=a.memo((({row:e,isActive:t})=>{const{theme:n}=(0,c.u)();return"groupValues"in e.original?(0,p.Y)(d.TableRow,{className:"eval-runs-table-row",children:(0,p.Y)(d.TableCell,{children:(0,p.FD)("div",{css:(0,r.AH)({display:"flex",alignItems:"center",gap:n.spacing.sm},""),children:[(0,p.Y)(c.B,{componentId:"mlflow.eval-runs.group-expand-button",size:"small",css:fe,icon:e.getIsExpanded()?(0,p.Y)(d.ChevronDownIcon,{}):(0,p.Y)(c.o,{}),onClick:e.getToggleExpandedHandler()}),(0,p.Y)(c.T.Text,{bold:!0,children:(0,p.Y)(m.A,{id:"UWHfmZ",defaultMessage:"Group:"})}),e.original.groupValues.map((e=>(0,p.Y)(ge,{groupValues:e},e.groupByData)))]})})},e.id):(0,p.Y)(d.TableRow,{className:"eval-runs-table-row",children:e.getVisibleCells().map((e=>{var r;return(0,p.Y)(d.TableCell,{css:[null===(r=e.column.columnDef.meta)||void 0===r?void 0:r.styles,{backgroundColor:t?n.colors.actionDefaultBackgroundHover:"transparent"},""],children:(0,de.Kv)(e.column.columnDef.cell,e.getContext())},e.id)}))},e.id)}),((e,t)=>e.isActive===t.isActive&&e.isSelected===t.isSelected&&e.columns===t.columns&&e.isExpanded===t.isExpanded&&e.isHidden===t.isHidden));var ye={name:"82a6rk",styles:"flex:1"};const be=(0,a.forwardRef)((({data:e,uniqueColumns:t,selectedColumns:n,selectedRunUuid:r,setSelectedRunUuid:o,isLoading:i,hasNextPage:s,rowSelection:l,setRowSelection:u,setSelectedDatasetWithRun:c,setIsDrawerOpen:h,viewMode:g,onScroll:f},y)=>{const[b,R]=(0,a.useState)([]),[w,x]=(0,a.useState)(!0),{isRowHidden:S}=k(),C=(0,a.useMemo)((()=>{const e=(e=>{const t=[{id:re.checkbox,cell:F,enableResizing:!1,enableSorting:!1,size:32,meta:{styles:{minWidth:32,maxWidth:32}}}];e===X.CHARTS&&t.push({id:re.visibility,header:te,cell:$,enableResizing:!1,enableSorting:!1,size:40,meta:{styles:{minWidth:40,maxWidth:40,padding:"0 4px"}}});const n=[{id:re.runName,header:()=>(0,p.Y)(m.A,{...se[re.runName]}),cell:H,enableResizing:!0,meta:{styles:{minWidth:100}}},{id:re.createdAt,header:e=>(0,p.Y)(j,{...e,title:(0,p.Y)(m.A,{...se[re.createdAt]})}),accessorFn:e=>{if(!("subRuns"in e))return e.info.startTime},cell:Q,enableSorting:!0,sortingFn:"alphanumeric",enableResizing:!0,meta:{styles:{minWidth:100}}},{id:re.dataset,header:()=>(0,p.Y)(m.A,{...se[re.dataset]}),cell:B,enableResizing:!0,meta:{styles:{minWidth:100}}},{id:re.modelVersion,header:()=>(0,p.Y)(m.A,{...se[re.modelVersion]}),cell:P,enableResizing:!0,meta:{styles:{minWidth:100}}}];return[...t,...n]})(g);return t.forEach((t=>{e.push({id:t,accessorFn:e=>{if(!("subRuns"in e))return((e,t)=>{var n,r,o,i,a,s,l,u,d,c,m,p,h;const{columnType:g,key:f}=null!==(n=Y(e))&&void 0!==n?n:{};if(f)switch(g){case oe.METRIC:return null!==(r=null===(o=t.data)||void 0===o||null===(i=o.metrics)||void 0===i||null===(a=i.find((e=>e.key===f)))||void 0===a?void 0:a.value)&&void 0!==r?r:void 0;case oe.PARAM:return null!==(s=null===(l=t.data)||void 0===l||null===(u=l.params)||void 0===u||null===(d=u.find((e=>e.key===f)))||void 0===d?void 0:d.value)&&void 0!==s?s:void 0;case oe.TAG:return null!==(c=null===(m=t.data)||void 0===m||null===(p=m.tags)||void 0===p||null===(h=p.find((e=>e.key===f)))||void 0===h?void 0:h.value)&&void 0!==c?c:void 0;default:return}})(t,e)},cell:V,header:j,enableSorting:!0,sortingFn:"alphanumeric",meta:{styles:{minWidth:100,maxWidth:200}}})})),e.filter((e=>{var t;return n[null!==(t=e.id)&&void 0!==t?t:""]}))}),[n,t,g]),D=(0,v.L)("mlflow/server/js/src/experiment-tracking/pages/experiment-evaluation-runs/ExperimentEvaluationRunsTable.tsx",{columns:C,data:e,getCoreRowModel:(0,ue.HT)(),getRowId:(e,t)=>"info"in e?e.info.runUuid:e.groupKey,enableSorting:!0,onSortingChange:R,getSortedRowModel:(0,ue.h5)(),enableColumnResizing:!1,enableExpanding:!0,getExpandedRowModel:(0,ue.D0)(),getSubRows:e=>{if("subRuns"in e)return e.subRuns},getRowCanExpand:e=>{var t;return Boolean(null===(t=e.subRows)||void 0===t?void 0:t.length)},onExpandedChange:x,meta:{setSelectedRunUuid:o,setSelectedDatasetWithRun:c,setIsDrawerOpen:h},onRowSelectionChange:u,state:{rowSelection:l,sorting:b,expanded:w}});return(0,p.FD)(d.Table,{css:ye,scrollable:!0,onScroll:f,ref:y,children:[(0,p.Y)(d.TableRow,{isHeader:!0,children:D.getLeafHeaders().map((e=>{var t;return(0,p.Y)(d.TableHeader,{css:null===(t=e.column.columnDef.meta)||void 0===t?void 0:t.styles,sortable:e.column.getCanSort(),sortDirection:e.column.getIsSorted(),onToggleSort:e.column.getToggleSortingHandler(),componentId:"mlflow.eval-runs.header",header:e,column:e.column,children:(0,de.Kv)(e.column.columnDef.header,e.getContext())},e.id)}))}),!i&&D.getRowModel().rows.map((e=>{const t="info"in e.original&&e.original.info.runUuid===r,n="info"in e.original?e.original.info.status:void 0;return(0,p.Y)(ve,{row:e,isActive:t,isSelected:l[e.id],isExpanded:e.getIsExpanded(),isHidden:S(e.id,e.index,n),columns:C},e.id)})),(i||s)&&(0,p.Y)(d.TableSkeletonRows,{table:D})]})}));var Re=n(25637),we=n(42595),xe=n(91299),Se=n(8740),Ce=n(61060),De=n(12803);var Me=n(76118),Ye=n(18585),Ie=n(181);const Te=({groupByConfig:e,setGroupByConfig:t,runs:n})=>{const r=n.some((e=>{var t,n,r;return(null!==(t=null===(n=e.inputs)||void 0===n||null===(r=n.datasetInputs)||void 0===r?void 0:r.length)&&void 0!==t?t:0)>0})),{uniqueParams:o,uniqueTags:i}=(0,a.useMemo)((()=>{const e=new Set,t=new Set;for(const s of n){for(const t of null!==(r=null===(o=s.data)||void 0===o?void 0:o.params)&&void 0!==r?r:[]){var r,o;e.add(t.key)}for(const e of null!==(i=null===(a=s.data)||void 0===a?void 0:a.tags)&&void 0!==i?i:[]){var i,a;(0,Ie.oD)(e.key)&&t.add(e.key)}}return{uniqueParams:e,uniqueTags:t}}),[n]),s=(n,r)=>{var o;const i=null!==(o=null===e||void 0===e?void 0:e.groupByKeys)&&void 0!==o?o:[],a=new Set(i);if((0,Ye.sd)(e,n,r))for(const e of a)e.mode===n&&e.groupByData===r&&a.delete(e);else a.add({mode:n,groupByData:r});var s;0===a.size?t(null):t({aggregateFunction:null!==(s=null===e||void 0===e?void 0:e.aggregateFunction)&&void 0!==s?s:ce.it.Average,groupByKeys:Array.from(a)})};return(0,p.FD)(d.DialogCombobox,{componentId:"mlflow.eval-runs.table-column-selector",label:"Group by",multiSelect:!0,children:[(0,p.Y)(d.DialogComboboxTrigger,{}),(0,p.Y)(d.DialogComboboxContent,{children:(0,p.FD)(d.DialogComboboxOptionList,{children:[r&&(0,p.FD)(p.FK,{children:[(0,p.Y)(d.DialogComboboxSectionHeader,{children:(0,p.Y)(m.A,{id:"BfMFME",defaultMessage:"Attributes"})}),(0,p.Y)(d.DialogComboboxOptionListCheckboxItem,{value:"dataset",checked:(0,Ye.sd)(e,ce.uq.Dataset,"dataset"),onChange:()=>{s(ce.uq.Dataset,"dataset")}},"dataset")]}),o.size>0&&(0,p.FD)(p.FK,{children:[(0,p.Y)(d.DialogComboboxSectionHeader,{children:(0,p.Y)(m.A,{id:"lS7kq2",defaultMessage:"Parameters"})}),Array.from(o).map((t=>(0,p.Y)(d.DialogComboboxOptionListCheckboxItem,{value:t,checked:(0,Ye.sd)(e,ce.uq.Param,t),onChange:()=>{s(ce.uq.Param,t)}},t)))]}),i.size>0&&(0,p.FD)(p.FK,{children:[(0,p.Y)(d.DialogComboboxSectionHeader,{children:(0,p.Y)(m.A,{id:"sEVVSd",defaultMessage:"Tags"})}),Array.from(i).map((t=>(0,p.Y)(d.DialogComboboxOptionListCheckboxItem,{value:t,checked:(0,Ye.sd)(e,ce.uq.Tag,t),onChange:()=>{s(ce.uq.Tag,t)}},t)))]})]})})]})};const Ae=e=>{const t=new Set,n=new Set,r=[];return e.forEach((e=>{var o,i,a;null===(o=e.data.metrics)||void 0===o||o.forEach((e=>{t.add(e.key)})),null===(i=e.data.params)||void 0===i||i.forEach((e=>{n.add(e.key)}));const s={};null===(a=e.data.tags)||void 0===a||a.forEach((e=>{s[e.key]={key:e.key,value:e.value}})),r.push(s)})),{metricKeyList:Array.from(t),paramKeyList:Array.from(n),tagsList:r}};var ke={name:"ozd7xs",styles:"flex-shrink:0"},Ee={name:"ovk77c",styles:"min-width:0"},Fe={name:"ozd7xs",styles:"flex-shrink:0"};const Le=({rowSelection:e,setRowSelection:t,refetchRuns:n,isFetching:o,runs:i,searchRunsError:s,searchFilter:l,setSearchFilter:u,selectedColumns:h,setSelectedColumns:g,groupByConfig:f,setGroupByConfig:v,viewMode:y,setViewMode:R})=>{const w=(0,ee.A)(),{theme:x}=(0,c.u)(),[S,C]=(0,a.useState)(!1),D=Object.entries(e).filter((([e,t])=>t)).map((([e])=>e)),{mutate:M,isLoading:I}=(({onSuccess:e,onError:t})=>{const{mutate:n,isLoading:r}=(0,Ce.n)({mutationFn:({runUuids:e})=>Promise.all(e.map((e=>De.x.deleteRun({run_id:e})))),onSuccess:e,onError:t});return{mutate:n,isLoading:r}})({onSuccess:()=>{n(),t({}),C(!1)}}),T=(0,a.useCallback)((()=>{M({runUuids:D})}),[M,D]),A=(0,a.useMemo)((()=>(0,Me.groupBy)(Object.entries(h),(([e])=>{var t,n;return null!==(t=null===(n=Y(e))||void 0===n?void 0:n.columnType)&&void 0!==t?t:oe.ATTRIBUTE}))),[h]);return(0,p.FD)("div",{css:(0,r.AH)({display:"flex",flexDirection:"column",gap:x.spacing.sm},""),children:[(0,p.FD)("div",{css:(0,r.AH)({display:"flex",gap:x.spacing.sm},""),children:[(0,p.FD)(d.SegmentedControlGroup,{name:"mlflow.eval-runs.page-mode-selector",componentId:"mlflow.eval-runs.page-mode-selector",value:y,css:ke,children:[(0,p.Y)(d.SegmentedControlButton,{value:X.TRACES,icon:(0,p.Y)(b.T,{componentId:"mlflow.eval-runs.traces-mode-toggle-tooltip",content:(0,p.Y)(m.A,{id:"nIk08y",defaultMessage:"Trace view"}),delayDuration:0,children:(0,p.Y)(d.ListBorderIcon,{})}),onClick:()=>null===R||void 0===R?void 0:R(X.TRACES)}),(0,p.Y)(d.SegmentedControlButton,{value:X.CHARTS,icon:(0,p.Y)(b.T,{componentId:"mlflow.eval-runs.charts-mode-toggle-tooltip",content:(0,p.Y)(m.A,{id:"RUju4k",defaultMessage:"Charts"}),delayDuration:0,children:(0,p.Y)(d.ChartLineIcon,{})}),onClick:()=>null===R||void 0===R?void 0:R(X.CHARTS)})]}),(0,p.Y)(Se.D,{css:Ee,runsData:Ae(i),searchFilter:l,onSearchFilterChange:u,onClear:()=>u(""),requestError:s}),(0,p.Y)(c.B,{css:Fe,icon:(0,p.Y)(d.RefreshIcon,{}),disabled:o,onClick:n,componentId:"mlflow.eval-runs.table-refresh-button"})]}),(0,p.FD)("div",{css:(0,r.AH)({display:"flex",gap:x.spacing.sm},""),children:[(0,p.FD)(d.DialogCombobox,{componentId:"mlflow.eval-runs.table-column-selector",label:"Columns",multiSelect:!0,children:[(0,p.Y)(d.DialogComboboxTrigger,{}),(0,p.Y)(d.DialogComboboxContent,{children:(0,p.Y)(d.DialogComboboxOptionList,{children:Object.entries(A).map((([e,t])=>{if(!t.length)return null;const n=le[e];return(0,p.FD)(p.FK,{children:[(0,p.Y)(b.S,{size:"xs"}),(0,p.Y)(d.DialogComboboxSectionHeader,{children:n?w.formatMessage(n):e}),t.map((([e,t])=>{var n,r;const o=se[e],i=o?w.formatMessage(o):null!==(n=null===(r=Y(e))||void 0===r?void 0:r.key)&&void 0!==n?n:e;return ie.has(e)?null:(0,p.Y)(d.DialogComboboxOptionListCheckboxItem,{value:e,onChange:()=>{const n={...h};n[e]=!t,g(n)},checked:t,children:i},e)}))]})}))})})]}),(0,p.Y)(Te,{groupByConfig:f,setGroupByConfig:v,runs:i}),D.length>0&&(0,p.FD)("div",{css:(0,r.AH)({display:"flex",flexDirection:"row",gap:x.spacing.sm},""),children:[(0,p.Y)(c.B,{danger:!0,componentId:"select-all-runs-button",onClick:()=>C(!0),children:(0,p.Y)(m.A,{id:"7gOeQm",defaultMessage:"Delete"})}),(0,p.Y)(b.d,{componentId:"mlflow.eval-runs.runs-delete-modal",visible:S,onOk:T,okButtonProps:{danger:!0,loading:I},okText:(0,p.Y)(m.A,{id:"EBwDIg",defaultMessage:"Delete"}),onCancel:()=>{C(!1)},cancelText:(0,p.Y)(m.A,{id:"2+EUFB",defaultMessage:"Cancel"}),confirmLoading:I,title:(0,p.Y)(m.A,{id:"mmz4aA",defaultMessage:"Delete {numRuns, plural, =1 {1 run} other {# runs}}",values:{numRuns:D.length}}),children:(0,p.Y)(m.A,{id:"xIP8WW",defaultMessage:"Are you sure you want to delete these runs?"})})]})]})]})};var He=n.p+"static/media/eval-runs-empty.5b96bbb9a4c5dc6b413000491892bb6f.svg",Oe=n(11522),Ue=n(48292);const Ne="selectedRunUuid";var Be=n(19112);const _e=e=>`import mlflow\nfrom mlflow.genai import datasets, evaluate, scorers\n\nmlflow.set_experiment(experiment_id="${e}")\n\n# Step 1: Define evaluation dataset\neval_dataset = [{\n  "inputs": {\n    "query": "What is MLflow?",\n  }\n}]\n\n# Step 2: Define predict_fn\n# predict_fn will be called for every row in your evaluation\n# dataset. Replace with your app's prediction function.\n# NOTE: The **kwargs to predict_fn are the same as the keys of\n# the \`inputs\` in your dataset.\ndef predict(query):\n  return query + " an answer"\n\n# Step 3: Run evaluation\nevaluate(\n  data=eval_dataset,\n  predict_fn=predict,\n  scorers=scorers.get_all_scorers()\n)\n\n# Results will appear back in this UI`,ze=({experimentId:e})=>{(0,ee.A)();const{theme:t}=(0,c.u)(),[n,o]=(0,a.useState)(!1),i=(0,p.Y)(m.A,{id:"7BkVQ9",defaultMessage:"Run the following code to start an evaluation."}),s=(0,p.Y)(Be.z7,{theme:t.isDarkMode?"duotoneDark":"light",language:"python",children:_e(e)});return(0,p.FD)(p.FK,{children:[(0,p.Y)(c.B,{componentId:"mlflow.eval-runs.start-run-button",icon:(0,p.Y)(d.ChartLineIcon,{}),onClick:()=>o(!0),children:(0,p.Y)(m.A,{id:"cMa3hp",defaultMessage:"Run evaluation"})}),(0,p.Y)(b.d,{componentId:"mlflow.eval-runs.start-run-modal",title:(0,p.Y)(m.A,{id:"3QGkg9",defaultMessage:"Run evaluation"}),visible:n,okText:"Discard",footer:null,onCancel:()=>o(!1),children:(0,p.FD)("div",{css:(0,r.AH)({display:"flex",flexDirection:"column",gap:t.spacing.sm},""),children:[(0,p.Y)(c.T.Text,{children:i}),s]})})]})},qe=e=>e.mode===ce.uq.Dataset?`Dataset: ${e.value}`:`${e.groupByData} (${e.mode}): ${e.value}`,Pe=(e,t)=>{var n,r,o,i,a,s,l,u,d,c,m;const p=t.groupByKeys,h=[];for(const g of p)switch(g.mode){case ce.uq.Dataset:h.push({mode:ce.uq.Dataset,groupByData:"dataset",value:null!==(n=null===(r=e.inputs)||void 0===r||null===(o=r.datasetInputs)||void 0===o||null===(i=o[0])||void 0===i||null===(a=i.dataset)||void 0===a?void 0:a.digest)&&void 0!==n?n:null});break;case ce.uq.Param:const t=null===(s=e.data)||void 0===s||null===(l=s.params)||void 0===l?void 0:l.find((e=>e.key===g.groupByData));h.push({mode:ce.uq.Param,groupByData:g.groupByData,value:null!==(u=null===t||void 0===t?void 0:t.value)&&void 0!==u?u:null});break;case ce.uq.Tag:const p=null===(d=e.data)||void 0===d||null===(c=d.tags)||void 0===c?void 0:c.find((e=>e.key===g.groupByData));h.push({mode:ce.uq.Tag,groupByData:g.groupByData,value:null!==(m=null===p||void 0===p?void 0:p.value)&&void 0!==m?m:null})}return h};var Ve=n(35286),We=n(29757),Ke=n(51120),je=n(95379),Qe=n(86133);const Ge=(e,t=1)=>`experiment-evaluation-runs-charts-ui-state-v${t}-${e}`,$e=()=>({compareRunCharts:void 0,compareRunSections:void 0,autoRefreshEnabled:!1,isAccordionReordered:!1,chartsSearchFilter:"",globalLineChartConfig:void 0,isDirty:!1}),Ze=(e,t)=>{if("UPDATE"===t.type)return{...t.stateSetter(e),isDirty:!0};if("METRICS_UPDATED"===t.type){const{compareRunCharts:n,compareRunSections:r}=(e=>{const t=(0,Me.compact)((0,Me.uniq)(e.map((e=>e.includes("/")?(0,Me.first)(e.split("/")):null)))),n=e.map((e=>{const t=e.includes("/")?(0,Me.first)(e.split("/")):null;return{deleted:!1,type:Qe.zL.BAR,uuid:`autogen-${e}`,metricSectionId:t?`autogen-${t}`:"default",isGenerated:!0,metricKey:e,displayName:e}})),r=t.map((e=>({display:!0,name:e,uuid:`autogen-${e}`,isReordered:!1})));return(0,Me.isEmpty)(r)&&r.push({display:!0,name:"Metrics",uuid:"default",isReordered:!1}),{compareRunCharts:n,compareRunSections:r}})(t.allMetricKeys);return((e,t)=>{var n,r;if((!e.compareRunCharts||!e.compareRunSections||!e.isDirty)&&(t.compareRunCharts.length>0||t.compareRunSections.length>0))return{...e,compareRunCharts:null!==(n=t.compareRunCharts)&&void 0!==n?n:[],compareRunSections:null!==(r=t.compareRunSections)&&void 0!==r?r:[]};const o=t.compareRunCharts.filter((t=>{var n;return!(null!==(n=e.compareRunCharts)&&void 0!==n&&n.find((e=>e.uuid===t.uuid)))})),i=t.compareRunSections.filter((t=>{var n;return o.find((e=>e.metricSectionId===t.uuid))&&!(null!==(n=e.compareRunSections)&&void 0!==n&&n.find((e=>e.uuid===t.uuid)))}));return i.length>0||o.length>0?{...e,compareRunCharts:e.compareRunCharts?[...e.compareRunCharts,...o]:t.compareRunCharts,compareRunSections:e.compareRunSections?[...e.compareRunSections,...i]:t.compareRunSections}:e})(e,{compareRunCharts:n,compareRunSections:r})}return"INITIALIZE"===t.type&&t.initialConfig?t.initialConfig:e},Xe=(e,t)=>{const[n,r]=(0,a.useReducer)(Ze,void 0,$e),[o,i]=(0,a.useState)(!0);(0,a.useEffect)((()=>{i(!0),(async e=>{const t=localStorage.getItem(Ge(e));if(t)try{return JSON.parse(t)}catch{return}})(t).then((e=>{r({type:"INITIALIZE",initialConfig:e}),i(!1)}))}),[t]),(0,a.useEffect)((()=>{o||r({type:"METRICS_UPDATED",allMetricKeys:e})}),[e,o]),(0,a.useEffect)((()=>{n.isDirty&&(async(e,t)=>{localStorage.setItem(Ge(e),JSON.stringify(t))})(t,n)}),[t,n]);const s=(0,a.useCallback)((e=>r({type:"UPDATE",stateSetter:e})),[]);return{chartUIState:n,updateUIState:s,loading:o}};var Je=n(33972),et=n(55600),tt=n(94119);const nt=[Qe.zL.LINE,Qe.zL.BAR,Qe.zL.CONTOUR,Qe.zL.DIFFERENCE,Qe.zL.PARALLEL,Qe.zL.SCATTER],rt=({runs:e=[],chartUIState:t})=>{var n;const r=(0,S.LE)(),{isRowHidden:o}=k(),i=(0,a.useMemo)((()=>e.filter((e=>e.info)).map(((e,t)=>{var n,i,a;const s=(0,Me.keyBy)(null===(n=e.data)||void 0===n?void 0:n.metrics,"key"),l=(0,Me.keyBy)(null===(i=e.data)||void 0===i?void 0:i.params,"key"),u=(0,Me.keyBy)(null===(a=e.data)||void 0===a?void 0:a.tags,"key");return{displayName:e.info.runName,images:{},metrics:s,params:l,tags:u,uuid:e.info.runUuid,color:r(e.info.runUuid),runInfo:e.info,hidden:o(e.info.runUuid,t,e.info.status)}}))),[e,o,r]),s=(0,a.useMemo)((()=>(0,Me.uniq)(i.flatMap((e=>Object.keys(e.metrics))))),[i]),l=(0,a.useMemo)((()=>(0,Me.uniq)(i.flatMap((e=>Object.keys(e.params))))),[i]),u=(0,je.KP)(),d=(0,je.iO)(),c=(0,je.cA)(),m=(0,je.Ez)(),[h,g]=(0,a.useState)(null),f=(0,a.useCallback)((e=>t=>g(Qe.i$.getEmptyChartCardByType(t,!1,void 0,e))),[]),v=(0,a.useMemo)((()=>({runs:i})),[i]);return(0,p.Y)("div",{children:(0,p.Y)(Ve.W,{contextData:v,component:tt.X,children:(0,p.FD)(We.c_,{visibleChartCards:t.compareRunCharts,children:[(0,p.Y)(Ke.J,{supportedChartTypes:nt,compareRunSections:t.compareRunSections,compareRunCharts:t.compareRunCharts,reorderCharts:d,insertCharts:c,chartData:i,startEditChart:g,removeChart:u,addNewChartCard:f,search:null!==(n=t.chartsSearchFilter)&&void 0!==n?n:"",groupBy:null,setFullScreenChart:()=>{},autoRefreshEnabled:t.autoRefreshEnabled,hideEmptyCharts:!1,globalLineChartConfig:t.globalLineChartConfig}),h&&(0,p.Y)(et.z,{chartRunData:i,metricKeyList:s,paramKeyList:l,config:h,onSubmit:e=>{m({...e,displayName:void 0}),g(null)},onCancel:()=>g(null),groupBy:null,supportedChartTypes:nt})]})})})},ot=({runs:e=[],experimentId:t})=>{const n=(0,a.useMemo)((()=>{const t=e.flatMap((e=>{var t,n;return(null===(t=e.data)||void 0===t||null===(n=t.metrics)||void 0===n?void 0:n.map((e=>e.key)))||[]}));return Array.from(new Set(t))}),[e]),r=(0,Je.i)((()=>n),[n]),{chartUIState:o,loading:i,updateUIState:s}=Xe(r,t);return i?(0,p.Y)(d.TableSkeleton,{lines:5}):(0,p.Y)(je.oB,{updateChartsUIState:s,children:(0,p.Y)(rt,{runs:e,chartUIState:o})})};var it={name:"1h0bf8r",styles:"body, :host{user-select:none;}"},at={name:"n56zw6",styles:"display:flex;flex-direction:row;flex:1;min-height:0px"},st={name:"5ob2ly",styles:"display:flex;position:relative"},lt={name:"1752fna",styles:"max-width:min(100%, 600px);text-align:center"},ut={name:"1bmnxg7",styles:"white-space:nowrap"},dt={name:"zt9k2r",styles:"max-width:100%;max-height:200px"};const ct=()=>{var e;const{experimentId:t}=(0,R.g)(),{theme:n}=(0,c.u)(),[o,l]=(0,a.useState)(432),[u,d]=(0,a.useState)(!1),[h,g]=(0,a.useState)(!1),[f,v]=(0,a.useState)(""),[y,b]=(0,a.useState)(),[w,x]=(0,a.useState)(!1),[S,C]=(0,a.useState)(ae),[D,Y]=(0,a.useState)(null),{viewMode:I,setViewMode:T}=(()=>{const[e,t]=(0,R.ok)();return{viewMode:(0,Z.SK)(X,e.get(J),X.TRACES),setViewMode:e=>{t((t=>{const n=new URLSearchParams(t);return n.set(J,e),n}))}}})(),[k,E]=(()=>{var e;const[t,n]=(0,R.ok)(),r=null!==(e=t.get(Ne))&&void 0!==e?e:void 0,o=(0,a.useCallback)((e=>{n((t=>void 0===e?(t.delete(Ne),t):(t.set(Ne,e),t)),{replace:!0})}),[n]);return[r,o]})();i()(t,"Experiment ID must be defined");const[F,L]=(0,a.useState)({}),{data:H,isLoading:O,isFetching:U,error:N,fetchNextPage:B,hasNextPage:_,refetch:z}=(0,s.X)({experimentId:t,enabled:!0,filter:f}),q=null!==(e=null===H||void 0===H?void 0:H.map((e=>e.info.runUuid)))&&void 0!==e?e:[];null===H||void 0===H||!H.length||k&&q.includes(k)||E(H[0].info.runUuid);const P=(0,a.useMemo)((()=>{const e=new Set,t=new Set,n=new Set;for(const a of null!==H&&void 0!==H?H:[]){for(const t of null!==(r=a.data.metrics)&&void 0!==r?r:[]){var r;e.add(t.key)}for(const e of null!==(o=a.data.params)&&void 0!==o?o:[]){var o;t.add(e.key)}for(const e of null!==(i=a.data.tags)&&void 0!==i?i:[]){var i;(0,Ie.oD)(e.key)&&n.add(e.key)}}return[...Array.from(e).map((e=>M(oe.METRIC,e))),...Array.from(t).map((e=>M(oe.PARAM,e))),...Array.from(n).map((e=>M(oe.TAG,e)))]}),[H]),V=(0,a.useMemo)((()=>Object.keys(ae)),[]),W=(0,a.useMemo)((()=>Object.keys(S).filter((e=>!V.includes(e)))),[V,S]);(0,a.useMemo)((()=>(0,Me.xor)(W,P)),[W,P]).length>0&&C({...ae,...(0,Me.mapValues)((0,Me.keyBy)(P),(()=>!1))});const K=0===q.length&&!f&&!O,j=((e,t)=>{if(!t)return e;const n={};for(const o of e){const e=Pe(o,t),r=e.map(qe).join(", ");n[r]||(n[r]={groupValues:e,subRuns:[]}),n[r].subRuns.push(o)}const r=[];return Object.entries(n).forEach((([e,{groupValues:t,subRuns:n}])=>{const o={groupKey:e,groupValues:t,subRuns:n};r.push(o)})),r})(null!==H&&void 0!==H?H:[],D),Q=(0,a.useRef)(null),G=(0,a.useCallback)((e=>{if(e){const{scrollHeight:t,scrollTop:n,clientHeight:r}=e;t-n-r<100&&!U&&_&&B()}}),[B,U,_]);return(0,a.useEffect)((()=>{G(Q.current)}),[G]),(0,p.Y)(A,{children:(0,p.FD)("div",{css:at,children:[(0,p.Y)(Re.ResizableBox,{css:st,style:{flex:`0 0 ${h?0:o}px`},width:o,axis:"x",resizeHandles:["e"],minConstraints:[250,0],handle:(0,p.Y)(we.z,{runListHidden:h,updateRunListHidden:e=>{g(!h)}}),onResize:(e,{size:t})=>{h||l(t.width)},onResizeStart:()=>!h&&d(!0),onResizeStop:()=>d(!1),children:(0,p.FD)("div",{css:(0,r.AH)({display:h?"none":"flex",flexDirection:"column",gap:n.spacing.sm,maxWidth:"100%",flex:1,zIndex:0,minHeight:"0px",overflow:"hidden",paddingRight:n.spacing.sm},""),children:[(0,p.Y)(Le,{runs:null!==H&&void 0!==H?H:[],refetchRuns:z,isFetching:U||O,searchRunsError:N,searchFilter:f,setSearchFilter:v,rowSelection:F,setRowSelection:L,selectedColumns:S,setSelectedColumns:C,groupByConfig:D,setGroupByConfig:Y,viewMode:I,setViewMode:T}),(0,p.Y)(be,{data:j,uniqueColumns:P,selectedColumns:S,selectedRunUuid:I===X.TRACES?k:void 0,setSelectedRunUuid:e=>{E(e)},isLoading:O,hasNextPage:null!==_&&void 0!==_&&_,rowSelection:F,setRowSelection:L,setSelectedDatasetWithRun:b,setIsDrawerOpen:x,viewMode:I,onScroll:e=>G(e.currentTarget),ref:Q})]})}),(0,p.Y)("div",{css:(0,r.AH)({flex:1,display:"flex",borderLeft:`1px solid ${n.colors.border}`,minHeight:"0px",overflowY:"scroll"},""),children:k?(0,p.Y)("div",{css:(0,r.AH)({display:"flex",flexDirection:"column",flex:1,minHeight:"0px",paddingLeft:n.spacing.sm},""),children:(e=>{var n;return I===X.CHARTS?(0,p.Y)(ot,{runs:H,experimentId:t}):(0,p.Y)(xe.r,{experimentId:t,runUuid:e,runDisplayName:Oe.A.getRunDisplayName(null===H||void 0===H||null===(n=H.find((t=>t.info.runUuid===e)))||void 0===n?void 0:n.info,e),setCurrentRunUuid:E})})(k)}):K?(0,p.FD)("div",{css:(0,r.AH)({display:"flex",flex:1,flexDirection:"column",justifyContent:"center",alignItems:"center",marginTop:n.spacing.lg,paddingLeft:n.spacing.md,maxWidth:"100%"},""),children:[(0,p.Y)(c.T.Title,{level:3,color:"secondary",children:(0,p.Y)(m.A,{id:"050N3C",defaultMessage:"Evaluate and improve the quality, cost, latency of your GenAI app"})}),(0,p.Y)(c.T.Paragraph,{color:"secondary",css:lt,children:(0,p.Y)(m.A,{id:"NKj5Xb",defaultMessage:"Create evaluation datasets in order to iteratively evaluate and improve your app. Run evaluations to check that your fixes are working, and compare quality between app / prompt versions. {learnMoreLink}",values:{learnMoreLink:(0,p.Y)(c.T.Link,{componentId:"mlflow.eval-runs.empty-state.learn-more-link",href:"https://mlflow.org/docs/latest/genai/eval-monitor/quickstart/",css:ut,openInNewTab:!0,children:(0,p.Y)(m.A,{id:"TdTXXf",defaultMessage:"Learn more"})})}})}),(0,p.Y)("img",{css:dt,src:He,alt:"No runs found"}),(0,p.Y)("div",{css:(0,r.AH)({display:"flex",gap:n.spacing.sm,marginTop:n.spacing.md},""),children:(0,p.Y)(ze,{experimentId:t})})]}):null}),u&&(0,p.Y)(r.mL,{styles:it}),y&&(0,p.Y)(Ue.O,{isOpen:w,setIsOpen:x,selectedDatasetWithRun:y,setSelectedDatasetWithRun:b})]})})};var mt=()=>(0,p.Y)(f,{children:(0,p.Y)(ct,{})})},50383:function(e,t,n){n.d(t,{f:function(){return u}});n(46709);var r=n(79081),o=n(7655),i=n(73408);const a=86400,s={timeZoneName:"short",year:"numeric",month:"numeric",day:"numeric",hour:"2-digit",minute:"2-digit"},l=({date:e,intl:t,tooltipFormatOptions:n=s})=>{const r=new Date,o=Math.round((r.getTime()-e.getTime())/1e3),i=navigator.language||"en-US";let l="";try{l=Intl.DateTimeFormat(i,n).format(e)}catch(u){}for(const s of(e=>[{seconds:31536e3,timeAgoMessage:t=>e.formatMessage({id:"NF6ePS",defaultMessage:"{count, plural, =1 {1 year} other {# years}} ago"},{count:t})},{seconds:2592e3,timeAgoMessage:t=>e.formatMessage({id:"N79Rdb",defaultMessage:"{count, plural, =1 {1 month} other {# months}} ago"},{count:t})},{seconds:a,timeAgoMessage:t=>e.formatMessage({id:"XwD3hV",defaultMessage:"{count, plural, =1 {1 day} other {# days}} ago"},{count:t})},{seconds:3600,timeAgoMessage:t=>e.formatMessage({id:"i1Hj20",defaultMessage:"{count, plural, =1 {1 hour} other {# hours}} ago"},{count:t})},{seconds:60,timeAgoMessage:t=>e.formatMessage({id:"ZO8PZt",defaultMessage:"{count, plural, =1 {1 minute} other {# minutes}} ago"},{count:t})},{seconds:1,timeAgoMessage:t=>e.formatMessage({id:"gQB+Vs",defaultMessage:"{count, plural, =1 {1 second} other {# seconds}} ago"},{count:t})}])(t)){const e=Math.floor(o/s.seconds);if(e>=1)return{displayText:s.timeAgoMessage(e),tooltipTitle:l}}return{displayText:t.formatMessage({id:"ZOsiNc",defaultMessage:"just now"}),tooltipTitle:l}},u=({date:e,tooltipFormatOptions:t=s})=>{const n=(0,o.A)(),{displayText:a,tooltipTitle:u}=l({date:e,intl:n,tooltipFormatOptions:t});return(0,i.Y)(r.T,{componentId:"web-shared.time-ago",content:u,children:(0,i.Y)("span",{children:a})})}},60062:function(e,t,n){n.d(t,{E:function(){return g}});var r=n(46709),o=n(48667),i=n(56606),a=n(27949),s=n(23403),l=n(4200);class u extends l.Q{constructor(e,t){super(),this.client=e,this.queries=[],this.result=[],this.observers=[],this.observersMap={},t&&this.setQueries(t)}onSubscribe(){1===this.listeners.size&&this.observers.forEach((e=>{e.subscribe((t=>{this.onUpdate(e,t)}))}))}onUnsubscribe(){this.listeners.size||this.destroy()}destroy(){this.listeners=new Set,this.observers.forEach((e=>{e.destroy()}))}setQueries(e,t){this.queries=e,a.j.batch((()=>{const e=this.observers,n=this.findMatchingObservers(this.queries);n.forEach((e=>e.observer.setOptions(e.defaultedQueryOptions,t)));const r=n.map((e=>e.observer)),o=Object.fromEntries(r.map((e=>[e.options.queryHash,e]))),a=r.map((e=>e.getCurrentResult())),s=r.some(((t,n)=>t!==e[n]));(e.length!==r.length||s)&&(this.observers=r,this.observersMap=o,this.result=a,this.hasListeners()&&((0,i.iv)(e,r).forEach((e=>{e.destroy()})),(0,i.iv)(r,e).forEach((e=>{e.subscribe((t=>{this.onUpdate(e,t)}))})),this.notify()))}))}getCurrentResult(){return this.result}getQueries(){return this.observers.map((e=>e.getCurrentQuery()))}getObservers(){return this.observers}getOptimisticResult(e){return this.findMatchingObservers(e).map((e=>e.observer.getOptimisticResult(e.defaultedQueryOptions)))}findMatchingObservers(e){const t=this.observers,n=new Map(t.map((e=>[e.options.queryHash,e]))),r=e.map((e=>this.client.defaultQueryOptions(e))),o=r.flatMap((e=>{const t=n.get(e.queryHash);return null!=t?[{defaultedQueryOptions:e,observer:t}]:[]})),i=new Set(o.map((e=>e.defaultedQueryOptions.queryHash))),a=r.filter((e=>!i.has(e.queryHash))),l=new Set(o.map((e=>e.observer))),u=t.filter((e=>!l.has(e))),d=e=>{const t=this.client.defaultQueryOptions(e),n=this.observersMap[t.queryHash];return null!=n?n:new s.$(this.client,t)},c=a.map(((e,t)=>{if(e.keepPreviousData){const n=u[t];if(void 0!==n)return{defaultedQueryOptions:e,observer:n}}return{defaultedQueryOptions:e,observer:d(e)}}));return o.concat(c).sort(((e,t)=>r.indexOf(e.defaultedQueryOptions)-r.indexOf(t.defaultedQueryOptions)))}onUpdate(e,t){const n=this.observers.indexOf(e);-1!==n&&(this.result=(0,i._D)(this.result,n,t),this.notify())}notify(){a.j.batch((()=>{this.listeners.forEach((({listener:e})=>{e(this.result)}))}))}}var d=n(39595),c=n(56718),m=n(77524),p=n(60164),h=n(2719);function g({queries:e,context:t}){const n=(0,d.jE)({context:t}),i=(0,c.w)(),s=(0,m.h)(),l=r.useMemo((()=>e.map((e=>{const t=n.defaultQueryOptions(e);return t._optimisticResults=i?"isRestoring":"optimistic",t}))),[e,n,i]);l.forEach((e=>{(0,h.tu)(e),(0,p.LJ)(e,s)})),(0,p.wZ)(s);const[g]=r.useState((()=>new u(n,l))),f=g.getOptimisticResult(l);(0,o.r)(r.useCallback((e=>i?()=>{}:g.subscribe(a.j.batchCalls(e))),[g,i]),(()=>g.getCurrentResult()),(()=>g.getCurrentResult())),r.useEffect((()=>{g.setQueries(l,{listeners:!1})}),[l,g]);const v=f.some(((e,t)=>(0,h.EU)(l[t],e,i)))?f.flatMap(((e,t)=>{const n=l[t],r=g.getObservers()[t];if(n&&r){if((0,h.EU)(n,e,i))return(0,h.iL)(n,r,s);(0,h.nE)(e,i)&&(0,h.iL)(n,r,s)}return[]})):[];if(v.length>0)throw Promise.all(v);const y=g.getQueries(),b=f.find(((e,t)=>{var n,r;return(0,p.$1)({result:e,errorResetBoundary:s,useErrorBoundary:null!=(n=null==(r=l[t])?void 0:r.useErrorBoundary)&&n,query:y[t]})}));if(null!=b&&b.error)throw b.error;return f}},70513:function(e,t,n){n.d(t,{Ef:function(){return l},b3:function(){return s}});var r=n(49708),o=n(61077);n(46709);const i=e=>["GET_LOGGED_MODEL",e],a=async({queryKey:[,e]})=>(0,o.ff)((0,o.we)(`ajax-api/2.0/mlflow/logged-models/${e}`),"GET"),s=({loggedModelId:e,enabled:t=!0})=>{const{data:n,isLoading:o,isFetching:s,refetch:l,error:u}=(0,r.I)({queryKey:i(null!==e&&void 0!==e?e:""),queryFn:a,cacheTime:0,refetchOnWindowFocus:!1,retry:!1,enabled:t});return{isLoading:o,isFetching:s,data:null===n||void 0===n?void 0:n.model,refetch:l,error:u}},l=async(e,t=!1)=>{try{return await(0,o.ff)((0,o.we)(`ajax-api/2.0/mlflow/logged-models/${e}`),"GET")}catch(n){if(t)return;throw n}}},72801:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.useClipboard=void 0;var o=r(n(90606)),i=n(46709),a=n(81619);function s(e){return e&&("TEXTAREA"===e.nodeName||"INPUT"===e.nodeName)}t.useClipboard=function(e){void 0===e&&(e={});var t=a.useTimedToggle(!1),n=t[0],r=t[1],l=i.useRef(null),u=i.useRef(e);return u.current=e,{copied:n,copy:i.useCallback((function(e){var t=u.current,n=l.current;function i(){t.onSuccess&&t.onSuccess(),t.copiedTimeout&&r(t.copiedTimeout),t.selectOnCopy&&s(n)&&n.select()}function a(){t.onError&&t.onError(),!1!==t.selectOnError&&s(n)&&n.select()}function d(e){o.default(e).then(i).catch(a)}"string"===typeof e?d(e):n&&d(n.value)}),[]),isSupported:function(){return!!navigator.clipboard||"function"===typeof document.execCommand&&"function"===typeof document.queryCommandSupported&&document.queryCommandSupported("copy")},target:l}}},95328:function(e,t,n){n.d(t,{X:function(){return a}});var r=n(96584),o=n(12803),i=n(46709);const a=({experimentId:e,enabled:t,filter:n})=>{const{data:a,fetchNextPage:s,hasNextPage:l,isLoading:u,isFetching:d,refetch:c,error:m}=(0,r.q)({queryKey:["SEARCH_RUNS",e,n],queryFn:async({pageParam:t})=>{const r={experiment_ids:[e],order_by:["attributes.start_time DESC"],run_view_type:"ACTIVE_ONLY",filter:n,max_results:50,page_token:t};return o.x.searchRuns(r)},cacheTime:0,refetchOnWindowFocus:!1,retry:!1,enabled:t,getNextPageParam:e=>e.next_page_token}),{evaluationRuns:p,trainingRuns:h}=(0,i.useMemo)((()=>{if(null===a||void 0===a||!a.pages)return{evaluationRuns:[],trainingRuns:[]};return a.pages.flatMap((e=>e.runs||[])).reduce(((e,t)=>{var n,r,o;return(null!==(n=null===(r=t.outputs)||void 0===r||null===(o=r.modelOutputs)||void 0===o?void 0:o.length)&&void 0!==n?n:0)?e.trainingRuns.push(t):e.evaluationRuns.push(t),e}),{evaluationRuns:[],trainingRuns:[]})}),[a]);return{data:p,trainingRuns:h,hasNextPage:l,fetchNextPage:s,refetch:c,isLoading:u,isFetching:d,error:m}}}}]);